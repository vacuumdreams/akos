!function(a){Akos=function(b,c,d){this.defaults={separator:"///",statuses:{enabled:{value:"1","class":""},disabled:{value:"0","class":"disabled"}},selectors:{container:".questions-content",noitems:".questinos-header-noitems",item:{content:".questions-item",question:".questions-item-question",answer:".questions-item-answer"},addForm:{actionClass:"saved",form:".add",question:".add-question-input",answer:".add-answer-input",submit:".add-btn"},editProcess:{actionClass:"edit-enabled",form:".edit",trigger:".edit-item",question:".edit-question",answer:".edit-answer",submit:".edit-submit",cancel:".edit-cancel"},deleteProcess:{actionClass:"questions-item-deleted",button:".delete-item",modal:".delete-confirm",confirm:".delete-confirm-approve",cancel:".delete-confirm-cancel"},statusProcess:{button:".status-item"},modals:{showClass:"modal-show",window:".modal",trigger:".modal-open",close:".modal-close"},quiz:{disabledClass:"quiz-disabled",startedClass:"quiz-started",actionCorrectClass:"correct",actionIncorrectClass:"incorrect",trigger:".quiz-start",stop:".quiz-stop",item:".quiz-item",question:".quiz-question",answer:".quiz-answer",submit:".quiz-submit",scoresAll:".quiz-score-all",scores:".quiz-score-points",progress:".quiz-progress"},template:{item:{name:"item",callback:"templateItem"},quizItem:{name:"quizItem",callback:"templateQuizItem"},quizEnd:{name:"quizEnd",callback:"templateQuizEnd"}}}},this.start=function(){f(),attachEvents()};var b=b?b:this.defaults.separator,c=c?c:this.defaults.statuses,d=d?d:this.defaults.selectors,e={getItems:function(b){var d,c=[];return a.each(localStorage,function(a,e){d={id:a,item:e},c.push(d),"function"==typeof b&&b(a,e)}),c},getItemsEnabled:function(){var c,b=[];return a.each(localStorage,function(a,d){"1"===d.charAt(0)&&(c={id:a,item:d},b.push(c))}),b},getNewId:function(){var c=0,d=0;return a.each(localStorage,function(a){c=parseInt(a),d=d>=c?d:c}),d+1},getSize:function(){return localStorage.length},get:function(a){return localStorage.getItem(a)},set:function(a,b){return localStorage.setItem(a,b)},remove:function(a){return localStorage.removeItem(a)}},f=function(){var b=e.getSize();b>0?(e.getItems(h),enableQuiz()):a(d.noitems).fadeIn(350)},h=function(a,b){b=i(b),j(a,b)},i=function(a){return a=a.split(b),{status:a[0],question:a[1],answer:a[2]}},j=function(b,c,e){a(d.container).append(k(b,c,e)).children().fadeIn(350)},k=function(a,b,c){return c=void 0===c?d.template.item:c,"templateItem"===c.callback?l(a,b):"templateQuizItem"===c.callback?m(a,b):"templateQuizEnd"===c.callback?n(a,b):void 0},l=function(a,b){var d=b.status===c.disabled.value?c.disabled.class:c.enabled.class;return'<div class="questions-item '+d+'" data-id="'+a+'"><div class="item-wrap"><div class="question-item-top"><button class="questions-item-button delete-item"><i class="icon-delete"></i></button><button class="questions-item-button edit-item"><i class="icon-edit"></i></button><button class="questions-item-button status-item"><i class="icon-status"></i></button></div><div class="questions-item-content"><p class="questions-item-question">'+b.question+'</p></div><form class="questions-item-form edit"><input class="edit-question" value="'+b.question+'" placeholder="Question"><input class="edit-answer" value="'+b.answer+'" placeholder="Answer"><div class="button-wrap"><button class="edit-submit">Save</button><button class="edit-cancel">Cancel</button></div></form></div></div>'},m=function(a,b){return'<div class="questions-item quiz-item" data-id="'+a+'"><div class="item-wrap"><div class="questions-item-content"><p class="quiz-question">'+b.question+'</p></div><form class="quiz-form"><input class="quiz-answer" placeholder="Answer"><div class="button-wrap"><button class="quiz-submit">Check</button><div class="quiz-feedbacks"><i class="quiz-message-icon quiz-correct icon-success"></i><i class="quiz-message-icon quiz-incorrect icon-fail"></i></div></div></form></div></div>'},n=function(a,b){var c;return c=a===b?"Perfect run!":a===b+1?"Almost made it. One mistake though.":"You answered correctly to "+b+" questions out of "+a,'<div class="quiz-end"><p>'+c+'</p><button class="quiz-stop">OK</button></div>'};attachEvents=function(){a(d.quiz.trigger).on("click",launchQuiz),a(d.addForm.submit).on("click",saveItem),a(d.container).on("click",d.editProcess.trigger,editItem).on("click",d.deleteProcess.button,deleteItem).on("click",d.statusProcess.button,statusToggleItem),a(document).on("click",d.modals.trigger,modalOpen).on("click",d.modals.close,modalClose)},modalOpen=function(b){b&&b.preventDefault(),a(a(this).data("trigger")).addClass(d.modals.showClass)},modalClose=function(b){b&&b.preventDefault(),a(this).closest(d.modals.window).removeClass(d.modals.showClass)},saveItem=function(f){var g=a(this).closest(d.addForm.form),h=g.children(d.addForm.question),i=g.children(d.addForm.answer),k=h.val(),l=i.val(),m=e.getNewId(),n=c.enabled.value;f.preventDefault(),g.removeClass(d.addForm.actionClass),e.set(m,n+b+k+b+l),j(m,{status:n,question:k,answer:l}),g.addClass(d.addForm.actionClass),h.val(""),i.val(""),1===e.getSize()&&(enableQuiz(),a(d.noitems).fadeOut(350)),setTimeout(function(){g.removeClass(d.addForm.actionClass)},3e3)},editItem=function(c){var f=a(this).closest(d.item.content),g=d.editProcess.actionClass,h=f.data("id"),j=function(c){var g=a(this).closest(d.editProcess.form),j=g.children(d.editProcess.question),l=g.children(d.editProcess.answer),m=i(e.get(h)),n=j.val()?j.val():m.question,o=l.val()?l.val():m.answer,p=m.status;c.preventDefault(),e.set(h,p+b+n+b+o),f.find(d.item.question).html(n),f.find(d.item.answer).html(o),j.val(n),l.val(o),k()},k=function(a){a&&a.preventDefault(),f.removeClass(g)};c.preventDefault(),f.addClass(g).on("click",d.editProcess.submit,j).on("click",d.editProcess.cancel,k)},destroyItem=function(b,c){e.remove(b),c.addClass(d.deleteProcess.actionClass).delay(350).queue(function(){a(this).detach().dequeue()})},deleteItem=function(){var b=a(this).closest(d.item.content),c=a(d.deleteProcess.modal),f=b.data("id"),g=function(b){b.preventDefault(),c.removeClass(d.modals.showClass),destroyItem(b.data.id,b.data.item),0===e.getSize()&&(disableQuiz(),a(d.noitems).fadeIn(350))};c.addClass(d.modals.showClass).on("click",d.deleteProcess.confirm,{id:f,item:b},g)},statusToggleItem=function(){var b=a(this).closest(d.item.content),f=b.data("id");currentValue=e.get(f),newStateValue=b.hasClass(c.disabled.class)?c.enabled.value:c.disabled.value,e.set(f,newStateValue+currentValue.slice(1)),b.toggleClass(c.disabled.class)},enableQuiz=function(){a(d.quiz.trigger).removeClass(d.quiz.disabledClass)},disableQuiz=function(){a(d.quiz.trigger).addClass(d.quiz.disabledClass)},launchQuiz=function(b){var c=a(this),g=e.getItemsEnabled(),h=g.length,k=0,l=0,o=(a(d.quiz.scores),function(a){for(var c,d,b=a.length;0!==b;)d=Math.floor(Math.random()*b),b-=1,c=a[b],a[b]=a[d],a[d]=c;return a}),p=function(b){var c=a(this).closest(d.quiz.item),f=c.data("id"),g=i(e.get(f)).answer,j=c.find(d.quiz.answer),m=j.val();b&&b.preventDefault(),g===m?(l++,k++,q(l),r(100*k/h),c.addClass(d.quiz.actionCorrectClass),setTimeout(function(){c.removeClass(d.quiz.actionCorrectClass),s(k)},500)):(k++,r(100*k/h),c.addClass(d.quiz.actionIncorrectClass),setTimeout(function(){c.removeClass(d.quiz.actionIncorrectClass),s(k)},500))},q=function(b){a(d.quiz.scores).html(b)},r=function(b){a(d.quiz.progress).css("width",b+"%")},s=function(b){var c;if(b<g.length){var c=g[b];a(d.container).fadeOut().delay(350).queue(function(){a(this).html("").show().dequeue(),j(c.id,i(c.item),d.template.quizItem),a(d.quiz.answer).focus()})}else a(d.container).fadeOut().delay(350).queue(function(){a(this).html("").show().dequeue(),j(h,l,d.template.quizEnd)})},t=function(b){b&&b.preventDefault(),a("body").removeClass(d.quiz.startedClass),a(d.container).fadeOut().delay(350).queue(function(){a(this).html("").show().dequeue(),f()})};b.preventDefault(),c.hasClass(d.quiz.disabledClass)||(a(d.quiz.scoresAll).html(h),q(l),r(k),a("body").addClass(d.quiz.startedClass).on("click",d.quiz.stop,t),a(d.container).on("click",d.quiz.submit,p),g=o(g),s(k))}}}(jQuery,window);